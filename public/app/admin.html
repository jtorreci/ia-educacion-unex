<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Admin - IA y Aprendizaje</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéì</text></svg>">
    <style>
        .admin-layout {
            display: grid;
            grid-template-columns: 240px 1fr;
            gap: 24px;
            margin-top: 20px;
        }

        .admin-sidebar {
            background: white;
            border-radius: var(--radio-grande);
            padding: 16px;
            box-shadow: var(--sombra-suave);
            height: fit-content;
            border: 1px solid rgba(0,0,0,0.04);
        }

        .admin-nav-item {
            display: block;
            padding: 11px 14px;
            border-radius: 8px;
            color: var(--gris-oscuro);
            text-decoration: none;
            margin-bottom: 4px;
            cursor: pointer;
            transition: var(--transicion);
            font-size: 0.925rem;
            font-weight: 500;
        }

        .admin-nav-item:hover {
            background: var(--gris-fondo);
            color: var(--azul-primario);
        }

        .admin-nav-item.active {
            background: var(--verde-primario);
            color: white;
            font-weight: 600;
        }

        .admin-content {
            background: white;
            border-radius: var(--radio-grande);
            padding: 32px;
            box-shadow: var(--sombra-suave);
            border: 1px solid rgba(0,0,0,0.04);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--gris-fondo);
            padding: 20px 16px;
            border-radius: var(--radio-borde);
            text-align: center;
            transition: var(--transicion);
        }

        .stat-card:hover {
            background: var(--verde-suave);
        }

        .stat-card .number {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--verde-primario);
            letter-spacing: -0.03em;
        }

        .stat-card .label {
            color: var(--gris-oscuro);
            font-size: 0.85rem;
            font-weight: 500;
            margin-top: 2px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th, .data-table td {
            padding: 12px 14px;
            text-align: left;
            border-bottom: 1px solid var(--gris-claro);
        }

        .data-table th {
            background: var(--gris-fondo);
            font-weight: 600;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.03em;
            color: var(--gris-oscuro);
        }

        .data-table tr:hover td {
            background: var(--gris-fondo);
        }

        .badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-pre { background: #EBF8FF; color: #2B6CB0; }
        .badge-post { background: #FAF5FF; color: #6B46C1; }
        .badge-reto { background: #FFFAF0; color: #C05621; }

        .export-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .export-card {
            background: var(--gris-fondo);
            padding: 24px 20px;
            border-radius: var(--radio-borde);
            text-align: center;
            transition: var(--transicion);
            border: 1px solid transparent;
        }

        .export-card:hover {
            border-color: var(--verde-primario);
            background: var(--verde-suave);
        }

        @media (max-width: 768px) {
            .admin-layout {
                grid-template-columns: 1fr;
            }
            .admin-content {
                padding: 22px;
            }
        }
    </style>
</head>
<body>
    <!-- Navegaci√≥n -->
    <nav class="navbar">
        <div class="container">
            <div class="navbar-content">
                <a href="/" class="navbar-brand">
                    <span class="navbar-logo">üéì</span>
                    <span>IA y Aprendizaje</span>
                </a>
                <div class="navbar-actions">
                    <span id="user-email" style="color: var(--gris-oscuro);"></span>
                    <button onclick="cerrarSesion()" class="btn btn-sm btn-outline">Cerrar sesi√≥n</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Contenido principal -->
    <section class="section">
        <div class="container">
            <!-- Mensajes -->
            <div id="mensaje-container"></div>

            <!-- Header -->
            <div class="dashboard-header">
                <div>
                    <h1>Panel de Administraci√≥n</h1>
                    <p style="color: var(--gris-oscuro);">Gesti√≥n del proyecto de investigaci√≥n</p>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">?</div>
                    <div>
                        <strong id="user-name">Cargando...</strong>
                        <p style="font-size: 0.85rem; color: var(--gris-oscuro);">Administrador</p>
                    </div>
                </div>
            </div>

            <!-- Layout -->
            <div class="admin-layout">
                <!-- Sidebar -->
                <div class="admin-sidebar">
                    <div class="admin-nav-item active" data-seccion="dashboard" onclick="mostrarSeccion('dashboard')">
                        üìä Dashboard
                    </div>
                    <div class="admin-nav-item" data-seccion="profesores" onclick="mostrarSeccion('profesores')">
                        üë®‚Äçüè´ Profesores
                    </div>
                    <div class="admin-nav-item" data-seccion="asignaturas" onclick="mostrarSeccion('asignaturas')">
                        üìö Asignaturas
                    </div>
                    <div class="admin-nav-item" data-seccion="respuestas" onclick="mostrarSeccion('respuestas')">
                        üìù Respuestas
                    </div>
                    <div class="admin-nav-item" data-seccion="exportar" onclick="mostrarSeccion('exportar')">
                        üì• Exportar datos
                    </div>

                    <div style="border-top: 1px solid var(--gris-claro); margin: 12px 0; padding-top: 12px;">
                        <div style="font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--gris-medio); padding: 0 14px 8px; font-weight: 600;">Vista previa</div>
                        <a href="profesor.html" class="admin-nav-item" style="text-decoration: none;">
                            üéì Panel Profesor
                        </a>
                        <a href="estudiante.html" class="admin-nav-item" style="text-decoration: none;">
                            üë©‚Äçüéì Panel Estudiante
                        </a>
                    </div>
                </div>

                <!-- Contenido -->
                <div class="admin-content">
                    <!-- Dashboard -->
                    <div id="seccion-dashboard" class="admin-section">
                        <h2>Resumen del proyecto</h2>

                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="number" id="stat-profesores">0</div>
                                <div class="label">Profesores</div>
                            </div>
                            <div class="stat-card">
                                <div class="number" id="stat-asignaturas">0</div>
                                <div class="label">Asignaturas</div>
                            </div>
                            <div class="stat-card">
                                <div class="number" id="stat-estudiantes">0</div>
                                <div class="label">Estudiantes</div>
                            </div>
                            <div class="stat-card">
                                <div class="number" id="stat-respuestas">0</div>
                                <div class="label">Cuestionarios</div>
                            </div>
                            <div class="stat-card">
                                <div class="number" id="stat-rubricas">0</div>
                                <div class="label">R√∫bricas</div>
                            </div>
                        </div>

                        <h3>Actividad reciente</h3>
                        <div id="actividad-reciente">
                            <p>Cargando...</p>
                        </div>
                    </div>

                    <!-- Profesores -->
                    <div id="seccion-profesores" class="admin-section" style="display: none;">
                        <h2>Gesti√≥n de Profesores</h2>

                        <div class="form-card" style="margin-bottom: 25px;">
                            <h3>A√±adir nuevo profesor</h3>
                            <form onsubmit="agregarProfesor(event)">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div class="form-group">
                                        <label class="required">Email institucional</label>
                                        <input type="email" name="email" class="form-control" placeholder="profesor@unex.es" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Nombre</label>
                                        <input type="text" name="nombre" class="form-control" placeholder="Nombre completo">
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-primary">A√±adir profesor</button>
                            </form>
                        </div>

                        <h3>Profesores registrados</h3>
                        <div id="lista-profesores">
                            <p>Cargando...</p>
                        </div>
                    </div>

                    <!-- Asignaturas -->
                    <div id="seccion-asignaturas" class="admin-section" style="display: none;">
                        <h2>Todas las Asignaturas</h2>
                        <div id="lista-asignaturas">
                            <p>Cargando...</p>
                        </div>
                    </div>

                    <!-- Respuestas -->
                    <div id="seccion-respuestas" class="admin-section" style="display: none;">
                        <h2>Respuestas de Investigaci√≥n</h2>
                        <p style="color: var(--gris-oscuro); margin-bottom: 20px;">
                            Datos an√≥nimos recopilados para el proyecto de investigaci√≥n.
                        </p>
                        <div id="lista-respuestas">
                            <p>Cargando...</p>
                        </div>
                    </div>

                    <!-- Exportar -->
                    <div id="seccion-exportar" class="admin-section" style="display: none;">
                        <h2>Exportar Datos</h2>
                        <p style="color: var(--gris-oscuro); margin-bottom: 25px;">
                            Descarga los datos de investigaci√≥n en formato JSON para an√°lisis.
                        </p>

                        <div class="export-grid">
                            <div class="export-card">
                                <h4>Cuestionarios PRE</h4>
                                <p style="font-size: 0.85rem; color: var(--gris-oscuro);">Conocimientos previos y actitudes</p>
                                <div style="display: flex; gap: 8px; margin-top: 10px; justify-content: center;">
                                    <button id="btn-exportar-pre" class="btn btn-sm btn-secondary">JSON</button>
                                    <button id="btn-exportar-pre-csv" class="btn btn-sm btn-primary">CSV</button>
                                </div>
                            </div>
                            <div class="export-card">
                                <h4>Cuestionarios POST</h4>
                                <p style="font-size: 0.85rem; color: var(--gris-oscuro);">Experiencia final</p>
                                <div style="display: flex; gap: 8px; margin-top: 10px; justify-content: center;">
                                    <button id="btn-exportar-post" class="btn btn-sm btn-secondary">JSON</button>
                                    <button id="btn-exportar-post-csv" class="btn btn-sm btn-primary">CSV</button>
                                </div>
                            </div>
                            <div class="export-card">
                                <h4>Encuestas de Retos</h4>
                                <p style="font-size: 0.85rem; color: var(--gris-oscuro);">Percepci√≥n de cada reto</p>
                                <div style="display: flex; gap: 8px; margin-top: 10px; justify-content: center;">
                                    <button id="btn-exportar-retos" class="btn btn-sm btn-secondary">JSON</button>
                                    <button id="btn-exportar-retos-csv" class="btn btn-sm btn-primary">CSV</button>
                                </div>
                            </div>
                            <div class="export-card">
                                <h4>R√∫bricas</h4>
                                <p style="font-size: 0.85rem; color: var(--gris-oscuro);">Evaluaciones de profesores</p>
                                <div style="display: flex; gap: 8px; margin-top: 10px; justify-content: center;">
                                    <button id="btn-exportar-rubricas" class="btn btn-sm btn-secondary">JSON</button>
                                    <button id="btn-exportar-rubricas-csv" class="btn btn-sm btn-primary">CSV</button>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 30px; padding: 20px; background: var(--verde-claro); border-radius: 10px;">
                            <h3 style="margin-bottom: 10px;">Exportaci√≥n completa</h3>
                            <p style="color: var(--gris-oscuro); margin-bottom: 15px;">
                                Descarga todos los datos en un √∫nico archivo para an√°lisis estad√≠stico.
                            </p>
                            <button id="btn-exportar-todo" class="btn btn-primary">Descargar todo</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-copy">
                Proyecto de Innovaci√≥n Docente ¬∑ Universidad de Extremadura ¬∑ 2025-2026
            </div>
        </div>
    </footer>

    <!-- Modal para detalle de respuestas -->
    <div id="modal-detalle" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 12px; padding: 30px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; position: relative;">
            <button onclick="cerrarModal()" style="position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--gris-oscuro);">&#10005;</button>
            <h2 id="modal-titulo" style="color: var(--azul-primario); margin-bottom: 20px;"></h2>
            <div id="modal-contenido"></div>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="../js/firebase-config.js"></script>
    <script src="../js/admin.js"></script>
</body>
</html>
